---
title: 技术美术知识学习5200：光追相关概念介绍
date: 2021-12-20 19:13:18
categories: 
    - [图形学]
    - [百人计划]
author: songjihu
avatar: 'http://82.156.182.226:8099/Avatar/avatar.jpg'
authorLink: 'http://82.156.182.226'
description: 光线追踪、路径追踪、光线投射、光线步进的简介
photos: http://82.156.182.226:8099/img/my/1c8c3f57-fddf-42d0-8038-5992afcf5c5c.png
mathjax: true

---

学习教程来自:[【技术美术百人计划】图形 5.2 光线追踪、路径追踪、光线投射、光线步进介绍](https://www.bilibili.com/video/BV1Mi4y1d7pX)

# 笔记

## 1. 光线追踪 Ray Tracing
光栅化渲染：并行的按照物体->三角面->像素拆解每个对象，缺少全局信息，无法精确实现一些效果  
光线追踪：一种渲染框架  
采用路径追踪的光线追踪方法步骤为：从相机出发，对每个像素点，向场景投射光线，直到光线与场景中第一个物体相交，在交点处根据物体性质、光源属性和光照模型等计算这个交点的颜色。然后，在交点处，该光线发生反射或折射，继续遍历追踪反射光线和折射光线，直到光线与下一个表面相交，计算该交点的颜色。直到光线到达光源或逸出场景。

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/QQ截图20211220192814.png
" width="80%" height="70%" >
<center>图片来自PPT</center>
</div>

<!-- $$
I = I_a + k_d\sum_{j=1}^{j=ls}(N \cdot L_j)+k_sS+k_tT
$$ --> 

<div align="center"><img style="background: white;" src="http://82.156.182.226:8099/img/my/R19lrr068D.svg"></div>

计算交点的方法：
1. 曲面方程和射线方程方程组求解
2. 计算射线与物体三角形面的交点
3. 优化：包围盒，空隙使用空间划分优化（八叉树、KD树、BSP树）


## 2. 光线投射 Ray Casting
<div align="center">
<img  src="http://82.156.182.226:8099/img/my/QQ截图20211220192656.png
" width="80%" height="70%" >
<center>图片来自PPT</center>
</div>
只考虑投射，不追踪后续

## 3. 路径追踪 Path Tracing
一种光线追踪方法
<div align="center">
<img  src="http://82.156.182.226:8099/img/my/QQ截图20211220201302.png 
" width="80%" height="70%" >
<center>图片来自PPT</center>
</div>

<!-- $$
L_o(p,\omega_o)=L_e(p,\omega_o)+\int_{S+}^{}f_r(p,\omega_i \to \omega_o)L_i(p,\omega_i)\cos \theta_i d \omega_i
$$ --> 


<div align="center"><img style="background: white;" src="http://82.156.182.226:8099/img/my/i0OB60FoeQ.svg"></div><center>出射光 = 自发光 + 半球上贡献的积分</center>

一些常见问题的处理办法：  
积分的求解：蒙特卡洛积分  
光线数量：一个像素块多条光线，反射时只产生一条光线，最终混合这些结果 
<div align="center">
<img  src="http://82.156.182.226:8099/img/my/QQ截图20211220203045.png
" width="80%" height="70%" >
<center>图片来自PPT</center>
</div> 

迭代终止：随机数法，每次迭代生成一个随机数决定是否继续  
光源面积小：不在半球上采样，通过变化直接在光源上采样

完整步骤：从相机出发，对每个像素点，向场景投射光线，直到光线与场景中第一个物体相交，在交点处根据物体性质、光源属性和光照模型等计算这个交点的颜色。然后，在交点处，该光线发生反射或折射，继续遍历追踪反射光线和折射光线，直到光线与下一个表面相交，计算该交点的颜色。直到光线到达光源或逸出场景。

## 4. 体积光线投射 Volume Ray Casting
体绘式技术（Volume Rendering）
<div align="center">
<img  src="http://82.156.182.226:8099/img/my/QQ截图20211221190953.png
" width="80%" height="70%" >
<center>采样三维纹理并混合</center>
</div>

## 5. 光线步进 Ray Marching
光线从起点步步前进，一步一计算直到终点

|应用场景|起点|终点|方向|
|:---:|:---:|:---:|:---:|
|屏幕空间反射(SSR)|反射面上的被计算的点|反射光线与被反射对象表面的交点|根据反射面法线和视线方向计算的反射方向|
|时差贴图|视线和模型表面的交点|视线和偏移表面的交点|视线方向
|体绘制|视点|视线和模型表面的交点|视线方向

## 6. 一些区别
递归式光线追踪（Whitted Style Ray Tracing）：每个像素一条光线
路径追踪：每个像素多条光线


# 作业
分析光线追踪、路径追踪、光线投射、光线步进在游戏中有哪些技术应用，paper

游戏中的应用 以下截屏来自来自Xbox Series X和3060显卡（Mincraft）

## 1. 地平线5 Forza 5
<div align="center">
<img  src="http://82.156.182.226:8099/img/my/QQ截图20211224202732.png
" width="100%" height="70%" >
<center></center>
</div>

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/da75eee7-d647-4f71-8466-c485bde1c833.png
" width="100%" height="70%" >
<center></center>
</div>

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/40076f1b-7932-4b81-a8b6-3a251e4b3cc1.png
" width="100%" height="70%" >
<center></center>
</div>


## 2. 灵媒 The Medium

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/QQ截图20211224225154.png
" width="100%" height="70%" >
<center></center>
</div>

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/8299e56d-5a1e-42d0-adda-5e9b8e2f58b1.png
" width="100%" height="70%" >
<center></center>
</div>

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/ac60d2ec-6f56-4acb-86fa-bb77763f841c.png
" width="100%" height="70%" >
<center></center>
</div>

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/e54d01d2-65fe-4f62-b7b2-85b2a8e378d9.png
" width="100%" height="70%" >
<center></center>
</div>




## 3. 我的世界 Minecraft

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/QQ截图20211225131300.png
" width="100%" height="70%" >
<center>GTX off</center>
</div>

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/QQ截图20211225131229.png
" width="100%" height="70%" >
<center>RTX on</center>
</div>






## 4. 黑客帝国觉醒 The Matrix Awakens
<div align="center">
<img  src="http://82.156.182.226:8099/img/my/QQ截图20211224203551.png
" width="70%" height="70%" >
<center></center>
</div>

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/e8ae9364-1c8f-47d0-a0a5-8aab1dfa39ab.png
" width="100%" height="70%" >
<center></center>
</div>

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/8d342c3d-b294-41ff-b686-a824cfabf05b.png
" width="100%" height="70%" >
<center></center>
</div>

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/1c8c3f57-fddf-42d0-8038-5992afcf5c5c.png
" width="100%" height="70%" >
<center></center>
</div>



## 5. 食人鲨 Maneater

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/deda05a4-ed5b-4bb3-9283-0703bba3ec09.png
" width="100%" height="70%" >
<center>RTX off</center>
</div>

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/204d4ea3-4a15-4f6c-9857-aed1c7ba5a0d.png
" width="100%" height="70%" >
<center>RTX on</center>
</div>

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/f7321ea5-be25-4967-b27d-e7005f7a5c01.png
" width="100%" height="70%" >
<center>RTX off</center>
</div>

<div align="center">
<img  src="http://82.156.182.226:8099/img/my/d2973d3e-93c7-433f-9c8b-a288c5d48779.png
" width="100%" height="70%" >
<center>RTX on</center>
</div>


